<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Synergier: Google Workspace & PowerOffice</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .flow-arrow {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0.5rem 0;
        }
        .flow-arrow::after {
            content: '▼';
            font-size: 1.5rem;
            color: #EE9B00;
        }
        @media (min-width: 1024px) {
            .flow-arrow::after {
                content: '►';
            }
        }
        .timeline-item {
            position: relative;
            padding-bottom: 2rem;
            padding-left: 2.5rem;
        }
        .timeline-item::before {
            content: attr(data-step);
            position: absolute;
            left: -0.25rem;
            top: -0.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            background-color: #0A9396;
            color: white;
            font-weight: bold;
            border: 4px solid #F8FAFC;
        }
        .timeline-item:not(:last-child)::after {
            content: '';
            position: absolute;
            left: 1rem;
            top: 2.5rem;
            width: 2px;
            height: calc(100% - 1rem);
            background-color: #94D2BD;
        }
        .loader {
            width: 48px;
            height: 48px;
            border: 5px solid #0A9396;
            border-bottom-color: transparent;
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }
        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .modal {
            transition: opacity 0.25s ease;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">
    <!-- Palette: Brilliant Blues (#005F73, #0A9396, #94D2BD, #E9D8A6, #EE9B00, #CA6702, #BB3E03, #AE2012, #9B2226) -->
    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-[#005F73] mb-2">Få Superkrefter i Hverdagen</h1>
            <p class="text-lg md:text-xl text-slate-600 max-w-3xl mx-auto">Slik skaper Google Workspace og PowerOffice et uslåelig team for små bedrifter.</p>
        </header>

        <main class="space-y-12">

            <section class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                <div class="bg-white rounded-lg shadow-md p-6 border-l-4 border-[#0A9396]">
                    <h2 class="text-2xl font-bold text-[#005F73] mb-2">Google Workspace</h2>
                    <p class="text-slate-600">Navet for kommunikasjon og samarbeid. E-post, kalender, skylagring og dokumenter som fungerer sømløst sammen.</p>
                </div>
                <div class="bg-white rounded-lg shadow-md p-6 border-l-4 border-[#EE9B00]">
                    <h2 class="text-2xl font-bold text-[#005F73] mb-2">PowerOffice</h2>
                    <p class="text-slate-600">Motoren for økonomi og administrasjon. Regnskap, faktura, lønn og prosjektstyring i ett komplett system.</p>
                </div>
            </section>
            
            <section class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-3xl font-bold text-[#005F73] text-center mb-2">De Åpenbare Synergiene</h2>
                <p class="text-slate-600 text-center max-w-2xl mx-auto mb-8">Dette er de direkte koblingene som umiddelbart forenkler hverdagen og reduserer dobbeltarbeid.</p>
                <div class="grid grid-cols-1 lg:grid-cols-5 gap-4 items-center text-center">
                    <div class="p-4 bg-slate-100 rounded-lg">
                        <p class="font-bold text-lg text-[#005F73]">Gmail</p>
                        <p class="text-sm text-slate-500">Sender fakturaer og purringer</p>
                    </div>
                    <div class="flow-arrow"></div>
                    <div class="p-4 bg-orange-100 rounded-lg">
                        <p class="font-bold text-lg text-[#CA6702]">PowerOffice</p>
                        <p class="text-sm text-slate-500">Genererer dokumentene</p>
                    </div>
                    <div class="flow-arrow"></div>
                    <div class="p-4 bg-slate-100 rounded-lg">
                        <p class="font-bold text-lg text-[#005F73]">Google Drive & Sheets</p>
                        <p class="text-sm text-slate-500">Lagrer og analyserer rapporter</p>
                    </div>
                </div>
            </section>

            <section>
                <h2 class="text-3xl font-bold text-[#005F73] text-center mb-8">Lås Opp Dypere Effektivitet</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <h3 class="text-xl font-bold text-[#005F73] mb-2">Automatiser Manuelle Oppgaver</h3>
                        <p class="text-slate-600 mb-4">Ved å koble systemene med verktøy som Zapier, kan du eliminere tidstyver. Dette diagrammet viser en typisk reduksjon i administrativ tid per uke for en liten bedrift.</p>
                        <div class="chart-container h-64 md:h-72">
                            <canvas id="automationChart"></canvas>
                        </div>
                    </div>
                    <div class="bg-white rounded-lg shadow-md p-6">
                        <h3 class="text-xl font-bold text-[#005F73] mb-2">Skap Dypere Innsikt</h3>
                        <p class="text-slate-600 mb-4">PowerOffice gir deg rådataene. Google Sheets og Looker Studio gir deg verktøyene til å visualisere og forstå dem på en ny måte, og skaper et komplett beslutningsgrunnlag.</p>
                         <div class="chart-container h-64 md:h-72">
                            <canvas id="insightChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <section class="bg-white rounded-lg shadow-md p-6 md:p-8">
                <h2 class="text-3xl font-bold text-[#005F73] text-center mb-2">✨ Få Skreddersydde Automatiseringsideer</h2>
                 <p class="text-slate-600 text-center max-w-3xl mx-auto mb-6">Fortell oss hva slags bedrift du driver, så gir Gemini deg kreative forslag til hvordan du kan spare tid ved å koble Google Workspace og PowerOffice.</p>
                <div class="max-w-xl mx-auto">
                    <div class="flex flex-col sm:flex-row gap-2">
                        <input type="text" id="businessTypeInput" placeholder="F.eks. 'Håndverkerbedrift med 5 ansatte'" class="flex-grow p-3 border border-slate-300 rounded-md focus:ring-2 focus:ring-[#EE9B00] focus:border-[#EE9B00] outline-none transition">
                        <button id="generateIdeasBtn" class="bg-[#0A9396] text-white font-bold py-3 px-6 rounded-md hover:bg-[#005F73] transition-colors duration-300">
                            Generer Ideer
                        </button>
                    </div>
                    <div id="ideasLoader" class="text-center py-6 hidden">
                        <div class="loader mx-auto"></div>
                        <p class="mt-2 text-slate-500">Gemini tenker...</p>
                    </div>
                    <div id="ideasResult" class="mt-6 p-4 bg-slate-50 rounded-lg"></div>
                </div>
            </section>
            
            <section class="bg-white rounded-lg shadow-md p-6 md:p-8">
                <h2 class="text-3xl font-bold text-[#005F73] text-center mb-2">Fra Tilbud til Betaling: En Sømløs Reise</h2>
                <p class="text-slate-600 text-center max-w-3xl mx-auto mb-10">Se for deg en typisk arbeidsflyt der systemene jobber sammen for å spare deg for tid og hodebry i hvert eneste ledd.</p>
                <div class="max-w-2xl mx-auto">
                    <div class="timeline-item" data-step="1">
                        <h4 class="font-bold text-lg text-[#005F73]">Tilbud skrives</h4>
                        <p class="text-slate-600">Et detaljert tilbud lages i Google Docs med maler og samarbeidsfunksjoner.</p>
                    </div>
                    <div class="timeline-item" data-step="2">
                        <h4 class="font-bold text-lg text-[#005F73]">Prosjekt opprettes</h4>
                        <p class="text-slate-600">Når kunden godkjenner, opprettes prosjektet i PowerOffice. Samtidig lages automatisk en delt prosjektmappe i Google Drive.</p>
                    </div>
                    <div class="timeline-item" data-step="3">
                        <h4 class="font-bold text-lg text-[#005F73]">Timer føres</h4>
                        <p class="text-slate-600">Ansatte fører timer i et enkelt Google Sheet, som automatisk synkroniseres til timeregistreringen i PowerOffice.</p>
                    </div>
                    <div class="timeline-item" data-step="4">
                        <h4 class="font-bold text-lg text-[#005F73]">Faktura sendes</h4>
                        <p class="text-slate-600">Faktura genereres i PowerOffice basert på de registrerte timene, og sendes til kunden via Gmail.</p>
                    </div>
                     <div class="timeline-item" data-step="5">
                        <h4 class="font-bold text-lg text-[#005F73]">Analyse og Rapportering</h4>
                        <p class="text-slate-600 mb-3">Prosjektdata eksporteres til Google Sheets for en dypere analyse av lønnsomhet, og presenteres for ledelsen.</p>
                        <button id="generateAgendaBtn" class="bg-[#EE9B00] text-white text-sm font-bold py-2 px-4 rounded-md hover:bg-[#CA6702] transition-colors duration-300">
                           ✨ Generer Møteagenda
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <footer class="text-center mt-12 py-6 border-t border-slate-200">
             <h3 class="text-2xl font-bold text-[#005F73] mb-2">Konklusjon: Ett Økosystem, Uendelige Muligheter</h3>
            <p class="text-slate-600 max-w-3xl mx-auto">
                Ved å kombinere Google Workspace og PowerOffice, går bedrifter fra å ha to gode verktøy til å skape ett helhetlig økosystem. Dette reduserer manuelt arbeid, gir dypere innsikt og styrker samarbeidet. For små bedrifter betyr dette en smartere, raskere og mer datadrevet hverdag.
            </p>
        </footer>
    </div>
    
    <div id="agendaModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 opacity-0 pointer-events-none">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-full overflow-y-auto p-6 relative">
            <button id="closeModalBtn" class="absolute top-4 right-4 text-slate-500 hover:text-slate-800 text-2xl">&times;</button>
            <div id="modalContent">
                 <h2 class="text-2xl font-bold text-[#005F73] mb-4">Forslag til Møteagenda</h2>
                 <div id="agendaLoader" class="text-center py-6">
                    <div class="loader mx-auto"></div>
                 </div>
                 <div id="agendaResult" class="text-slate-700 space-y-4"></div>
            </div>
        </div>
    </div>

    <script>
        function processLabels(labels) {
            const charLimit = 16;
            return labels.map(label => {
                if (label.length > charLimit) {
                    const words = label.split(' ');
                    const newLabel = [];
                    let line = '';
                    words.forEach(word => {
                        if ((line + word).length > charLimit) {
                            newLabel.push(line.trim());
                            line = '';
                        }
                        line += word + ' ';
                    });
                    newLabel.push(line.trim());
                    return newLabel;
                }
                return label;
            });
        }
        
        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) {
                return label.join(' ');
            }
            return label;
        };

        const sharedChartOptions = {
            maintainAspectRatio: false,
            responsive: true,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        color: '#475569',
                        font: { size: 12 }
                    }
                },
                tooltip: {
                    callbacks: {
                        title: tooltipTitleCallback
                    }
                }
            },
        };

        const automationCtx = document.getElementById('automationChart').getContext('2d');
        new Chart(automationCtx, {
            type: 'bar',
            data: {
                labels: processLabels(['Fakturering & Oppfølging', 'Rapportering', 'Dokumenthåndtering']),
                datasets: [{
                    label: 'Manuell Tid (timer/uke)',
                    data: [5, 4, 3],
                    backgroundColor: '#E9D8A6',
                    borderColor: '#CA6702',
                    borderWidth: 1
                }, {
                    label: 'Automatisert Tid (timer/uke)',
                    data: [1, 0.5, 0.5],
                    backgroundColor: '#94D2BD',
                    borderColor: '#0A9396',
                    borderWidth: 1
                }]
            },
            options: { ...sharedChartOptions,
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: { color: '#475569' },
                        grid: { color: '#E2E8F0' }
                    },
                    x: {
                        ticks: { color: '#475569' },
                        grid: { display: false }
                    }
                }
            }
        });

        const insightCtx = document.getElementById('insightChart').getContext('2d');
        new Chart(insightCtx, {
            type: 'doughnut',
            data: {
                labels: ['PowerOffice Rådata', 'Analyse i Google Sheets', 'Visualisering & Deling'],
                datasets: [{
                    label: 'Bidrag til Beslutning',
                    data: [50, 30, 20],
                    backgroundColor: [
                        '#0A9396',
                        '#94D2BD',
                        '#EE9B00'
                    ],
                    hoverOffset: 4
                }]
            },
            options: { ...sharedChartOptions }
        });

        const generateIdeasBtn = document.getElementById('generateIdeasBtn');
        const businessTypeInput = document.getElementById('businessTypeInput');
        const ideasLoader = document.getElementById('ideasLoader');
        const ideasResult = document.getElementById('ideasResult');

        const generateAgendaBtn = document.getElementById('generateAgendaBtn');
        const agendaModal = document.getElementById('agendaModal');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const agendaLoader = document.getElementById('agendaLoader');
        const agendaResult = document.getElementById('agendaResult');

        const apiKey = "";
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

        async function callGeminiAPI(prompt, retries = 3, delay = 1000) {
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
            };
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const result = await response.json();
                return result.candidates?.[0]?.content?.parts?.[0]?.text || "Beklager, kunne ikke hente et svar. Prøv igjen.";
            } catch (error) {
                if (retries > 0) {
                    await new Promise(res => setTimeout(res, delay));
                    return callGeminiAPI(prompt, retries - 1, delay * 2);
                }
                console.error("Error calling Gemini API:", error);
                return "Det oppstod en feil under kommunikasjon med AI-en. Vennligst sjekk konsollen for detaljer.";
            }
        }
        
        function formatResponse(text) {
             return text
                .replace(/\*\*(.*?)\*\*/g, '<strong class="text-[#005F73]">$1</strong>')
                .replace(/\* (.*?)(?=\n\* |$)/g, '<li class="mb-2 ml-4 p-2 bg-white rounded">$1</li>')
                .replace(/<\/li><li/g, '</li></ul><ul><li')
                .replace(/(<li.*<\/li>)/, '<ul>$1</ul>')
                .replace(/\n/g, '<br>');
        }

        generateIdeasBtn.addEventListener('click', async () => {
            const businessType = businessTypeInput.value.trim();
            if (!businessType) {
                ideasResult.innerHTML = '<p class="text-red-600">Vennligst skriv inn en bedriftstype.</p>';
                return;
            }
            ideasLoader.classList.remove('hidden');
            ideasResult.innerHTML = '';
            const prompt = `Act as a business efficiency expert for small Norwegian businesses. Provide 5 creative and practical automation ideas for a "${businessType}" using Google Workspace and PowerOffice, possibly with a tool like Zapier. Focus on non-obvious synergies. Format the response with a short intro, then a numbered list where each item has a bolded title and a short explanation. Use Norwegian language.`;
            const response = await callGeminiAPI(prompt);
            ideasLoader.classList.add('hidden');
            ideasResult.innerHTML = formatResponse(response);
        });

        generateAgendaBtn.addEventListener('click', async () => {
            agendaModal.classList.remove('opacity-0', 'pointer-events-none');
            agendaLoader.classList.remove('hidden');
            agendaResult.innerHTML = '';
            
            const prompt = `Act as a project manager. Create a concise meeting agenda in Norwegian for an internal meeting to discuss the profitability report of a recently completed project. The data comes from PowerOffice and is analyzed in Google Sheets. The agenda should include: meeting title, objective, attendees (roles), and 3-4 agenda points with a short description for each. The tone should be professional and action-oriented.`;
            
            const response = await callGeminiAPI(prompt);
            agendaLoader.classList.add('hidden');
            agendaResult.innerHTML = formatResponse(response);
        });

        const closeModal = () => {
            agendaModal.classList.add('opacity-0', 'pointer-events-none');
        };

        closeModalBtn.addEventListener('click', closeModal);
        agendaModal.addEventListener('click', (e) => {
            if (e.target === agendaModal) {
                closeModal();
            }
        });

    </script>
</body>
</html>
